gff <- read.delim("Diaprepes-curated-annotation.gff3", as.is = T,
header = F)
gff <- gff[gff$V3 %in% "polypeptide",]
gff$V9[1]
strsplit(gff$V9[1], split = ";")
unlist(strsplit(gff$V9[1], split = ";"))
unlist(strsplit(gff$V9[1], split = ";"))[2]
View(gff)
unlist(strsplit(gff$V9[1], split = "md5="))[2]
for(i in 1:nrow(gff)){
gff$V9[i] <- unlist(strsplit(gff$V9[i], split = "md5="))[2]
}
duplicated(gff$V9)
sum(duplicated(gff$V9))
gff$V1[!(duplicated(gff$V9))]
keep.genes <- gff$V1[!(duplicated(gff$V9))]
table(gff$V9) > 2
table(gff$V9)
sort(table(gff$V9),decreasing = T)
sort(table(gff$V9),decreasing = T) > 2
sum(sort(table(gff$V9),decreasing = T) > 2)
sum(sort(table(gff$V9),decreasing = T) > 2)
sum(sort(table(gff$V9),decreasing = T) > 3)
sum(sort(table(gff$V9),decreasing = T) > 4)
sum(sort(table(gff$V9),decreasing = T) > 5)
sum(sort(table(gff$V9),decreasing = T) > 6)
sum(sort(table(gff$V9),decreasing = T) > 7)
sum(sort(table(gff$V9),decreasing = T) > 8)
sum(sort(table(gff$V9),decreasing = T) > 9)
sum(sort(table(gff$V9),decreasing = T) > 0)
sum(sort(table(gff$V9),decreasing = T) > 10)
sum(sort(table(gff$V9),decreasing = T) > 11)
sum(sort(table(gff$V9),decreasing = T) > 12)
sum(sort(table(gff$V9),decreasing = T) > 13)
sum(sort(table(gff$V9),decreasing = T) > 14)
max(sort(table(gff$V9),decreasing = T))
sort(table(gff$V9),decreasing = T)
names(sort(table(gff$V9),decreasing = T))
names(sort(table(gff$V9),decreasing = T)>2)
sum(sort(table(gff$V9),decreasing = T)>2)
sum(table(gff$V9)[sort(table(gff$V9),decreasing = T)>2])
smes(table(gff$V9)[sort(table(gff$V9),decreasing = T)>2])
(table(gff$V9)[sort(table(gff$V9),decreasing = T)>2])
names(table(gff$V9)[sort(table(gff$V9),decreasing = T)>2])
dups <- names(table(gff$V9)[sort(table(gff$V9),decreasing = T)>2])
keep.genes <- gff$V1[!(gff$V9 %in% dups)]
keep.genes <- gff$V1[!(duplicated(gff$V9))]
keep.genes <- gff$V1[!(gff$V9 %in% dups)]
keep.genes <- gff$V1[(gff$V9 %in% dups)]
keep.genes <- gff$V1[(duplicated(gff$V9))]
duplicated(c(1,1,1,2,1,3))
duplicated(c(1,1,1,2,1,3),nmax = 1)
duplicated(c(1,1,1,2,1,3),nmax = 2)
?duplicated
anyDuplicated(c(1,1,1,2,1,3))
anyDuplicated(c(1,1,1,2,1,3,2))
anyDuplicated(c(1,1,1,2,1,3,2,2,2,2,2,2,2))
dups <- names(sort(table(gff$V9))[sort(table(gff$V9),decreasing = T)>2])
names(sort(table(gff$V9))[sort(table(gff$V9),decreasing = T)>2])
names(sort(table(gff$V9),decreasing = T)[sort(table(gff$V9),decreasing = T)>2])
dups <- names(sort(table(gff$V9),decreasing = T)[sort(table(gff$V9),decreasing = T)>2])
keep.genes <- gff$V1[(gff$V9 %in% dups)]
keep.genes <- gff$V1[!(gff$V9 %in% dups)]
gff <- read.delim("Diaprepes-curated-annotation.gff3", as.is = T,
header = F)
gff <- gff[gff$V1 %in% keep.genes,]
gff <- read.delim("Diaprepes-curated-annotation.gff3", as.is = T,
header = F)
gff <- gff[gff$V1 %in% keep.genes,]
gff <- read.delim("Diaprepes-curated-annotation.gff3", as.is = T,
header = F)
gff <- gff[gff$V3 %in% "polypeptide",]
for(i in 1:nrow(gff)){
gff$V9[i] <- unlist(strsplit(gff$V9[i], split = "md5="))[2]
}
keep.genes <- gff$V1[!(duplicated(gff$V9))]
gff <- read.delim("Diaprepes-curated-annotation.gff3", as.is = T,
header = F)
gff <- gff[gff$V1 %in% keep.genes,]
write(gff, "Diaprepes-nodup.gff")
write.table(gff, "Diaprepes-nodup.gff",row.names = F,col.names = F,quote = F,sep = "\t")
dups <- names(sort(table(gff$V9),decreasing = T)[sort(table(gff$V9),decreasing = T)>2])
gff.in <- read.delim("Diaprepes-curated-annotation.gff3", as.is = T,
header = F)
gff <- gff.in[gff.in$V3 %in% "polypeptide",]
for(i in 1:nrow(gff)){
gff$V9[i] <- unlist(strsplit(gff$V9[i], split = "md5="))[2]
}
dups <- names(sort(table(gff$V9),decreasing = T)[sort(table(gff$V9),decreasing = T)>2])
keep.genes.single <- gff$V1[!(gff$V9 %in% dups)]
gff.single <- gff[gff$V1 %in% keep.genes,]
gff.single <- gff[gff$V1 %in% keep.genes.single,]
gff.single <- gff.in[gff.in$V1 %in% keep.genes.single,]
write.table(gff.single, "Diaprepes-single.gff",row.names = F,col.names = F,quote = F,sep = "\t")
gff.in <- read.delim("Diaprepes-curated-annotation.gff3", as.is = T,
header = F)
gff <- gff.in[gff.in$V3 %in% "polypeptide",]
for(i in 1:nrow(gff)){
gff$V9[i] <- unlist(strsplit(gff$V9[i], split = "md5="))[2]
}
keep.genes <- gff$V1[!(duplicated(gff$V9))]
keep.genes.single <- gff$V1[!(gff$V9 %in% dups)]
dups <- names(sort(table(gff$V9),decreasing = T)[sort(table(gff$V9),decreasing = T)>2])
keep.genes.single <- gff$V1[!(gff$V9 %in% dups)]
dups
(gff$V9 %in% dups)
sum(gff$V9 %in% dups)

# read data
seq <- read.FASTA(file = "full.alignment/GH1-alignment.fasta",type = "DNA")
# load libraries
library(ape)
# read data
seq <- read.FASTA(file = "full.alignment/GH1-alignment.fasta",type = "DNA")
seq$18Dv_140636_c0_seq1_Diabrotica_virgifera_18Dv_140636_c0_seq1_Eyun_etal_2014_Insecta_Coleoptera_Chrysomelidae
seq[[1]]
# load libraries
library(seqinr)
# read data
seq <- read.fasta(file = "full.alignment/GH1-alignment.fasta",seqtype = "DNA")
seq[[1]]
seq[1]
seq[1][[1]]
seq[1]$18Dv_140636_c0_seq1_Diabrotica_virgifera_18Dv_140636_c0_seq1_Eyun_etal_2014_Insecta_Coleoptera_Chrysomelidae
seq[[1]][1]
seq[[1]]
length(seq[[1]])
(seq[[1]] == "-")
sum((seq[[1]] == "-"))
empty <- c()
for(i in 1:length(seq)){
empty[i] <- sum((seq[[i]] == "-")) / length(seq[[i]])
}
empty
hist(empty)
which(empty > 0.9)
which(empty > 0.8)
names(seq)
names(seq)[which(empty > 0.8)]
# get sequences with more than 80% missing data and remove them
drop <- names(seq)[which(empty > 0.8)]
seq[-drop]
seq[-(drop)]
seq[[drop]]
seq[1]
seq[2]
drop
# get sequences with more than 80% missing data and remove them
drop <- which(empty > 0.8)
# get sequences with more than 80% missing data and remove them
names(seq)[which(empty > 0.8)]
drop <- which(empty > 0.8)
seq[drop]
seq <- seq[-drop]
# write fasta file
write.fasta(sequences = seq,file.out = "full.alignment/GH1-alignment.ed.fasta")
# write fasta file
write.fasta(sequences = seq,names = names(seq),file.out = "full.alignment/GH1-alignment.ed.fasta")
names(seq)
# write fasta file
write.fasta(sequences = seq,
names = names(seq),
file.out = "full.alignment/GH1-alignment.ed.fasta")
# read data
seq <- read.fasta(file = "full.alignment/GH9-alignment.flank.pruned.fasta",seqtype = "DNA")
# read data
seq <- read.fasta(file = "full.alignment/GH9-alignment.flank.pruned.fasta",seqtype = "DNA")
empty <- c()
for(i in 1:length(seq)){
empty[i] <- sum((seq[[i]] == "-")) / length(seq[[i]])
}
# get sequences with more than 80% missing data and remove them
names(seq)[which(empty > 0.8)]
hist(empty)
# get sequences with more than 80% missing data and remove them
names(seq)[which(empty > 0.9)]
# get sequences with more than 80% missing data and remove them
names(seq)[which(empty > 0.8)]
drop <- which(empty > 0.8)
# remove these sequences
seq <- seq[-drop]
# write fasta file
write.fasta(sequences = seq,
names = names(seq),
file.out = "full.alignment/GH9-alignment.ed.fasta")
# read data
seq <- read.fasta(file = "full.alignment/GH28-alignment.flank.pruned.fasta",seqtype = "DNA")
# read data
seq <- read.fasta(file = "full.alignment/GH28-alignment.flank.pruned.fasta",seqtype = "DNA")
empty <- c()
for(i in 1:length(seq)){
empty[i] <- sum((seq[[i]] == "-")) / length(seq[[i]])
}
hist(empty)
# get sequences with more than 80% missing data and remove them
names(seq)[which(empty > 0.8)]
drop <- which(empty > 0.8)
# remove these sequences
seq <- seq[-drop]
length(drop)
# read data
seq <- read.fasta(file = "full.alignment/GH28-alignment.flank.pruned.fasta",seqtype = "DNA")
empty <- c()
for(i in 1:length(seq)){
empty[i] <- sum((seq[[i]] == "-")) / length(seq[[i]])
}
hist(empty)
# get sequences with more than 80% missing data and remove them
names(seq)[which(empty > 0.8)]
drop <- which(empty > 0.8)
# remove these sequences
length(drop != 0){
# read data
seq <- read.fasta(file = "full.alignment/GH28-alignment.flank.pruned.fasta",seqtype = "DNA")
empty <- c()
for(i in 1:length(seq)){
empty[i] <- sum((seq[[i]] == "-")) / length(seq[[i]])
}
hist(empty)
# get sequences with more than 80% missing data and remove them
names(seq)[which(empty > 0.8)]
drop <- which(empty > 0.8)
# remove these sequences
if(length(drop != 0)){
seq <- seq[-drop]
}
# write fasta file
write.fasta(sequences = seq,
names = names(seq),
file.out = "full.alignment/GH9-alignment.ed.fasta")
# write fasta file
write.fasta(sequences = seq,
names = names(seq),
file.out = "full.alignment/GH28-alignment.ed.fasta")
# read data
seq <- read.fasta(file = "full.alignment/GH32-alignment.flank.pruned.fasta",seqtype = "DNA")
empty <- c()
for(i in 1:length(seq)){
empty[i] <- sum((seq[[i]] == "-")) / length(seq[[i]])
}
hist(empty)
# get sequences with more than 80% missing data and remove them
names(seq)[which(empty > 0.8)]
# get sequences with more than 80% missing data and remove them
names(seq)[which(empty > 0.9)]
# get sequences with more than 80% missing data and remove them
names(seq)[which(empty > 0.8)]
# get sequences with more than 80% missing data and remove them
names(seq)[which(empty > 0.8)]
drop <- which(empty > 0.8)
# remove these sequences
if(length(drop != 0)){
seq <- seq[-drop]
}
# write fasta file
write.fasta(sequences = seq,
names = names(seq),
file.out = "full.alignment/GH32-alignment.ed.fasta")
# read data
seq <- read.fasta(file = "full.alignment/GH45-alignment.flank.pruned.fasta",seqtype = "DNA")
empty <- c()
for(i in 1:length(seq)){
empty[i] <- sum((seq[[i]] == "-")) / length(seq[[i]])
}
hist(empty)
# get sequences with more than 80% missing data and remove them
names(seq)[which(empty > 0.8)]
drop <- which(empty > 0.8)
# remove these sequences
if(length(drop != 0)){
seq <- seq[-drop]
}
# write fasta file
write.fasta(sequences = seq,
names = names(seq),
file.out = "full.alignment/GH45-alignment.ed.fasta")
# load libraries
library(seqinr)
# read data
seq <- read.fasta(file = "full.alignment/GH48-alignment.flank.pruned.fasta",seqtype = "DNA")
empty <- c()
for(i in 1:length(seq)){
empty[i] <- sum((seq[[i]] == "-")) / length(seq[[i]])
}
hist(empty)
# get sequences with more than 80% missing data and remove them
names(seq)[which(empty > 0.8)]
drop <- which(empty > 0.8)
# remove these sequences
if(length(drop != 0)){
seq <- seq[-drop]
}
# write fasta file
write.fasta(sequences = seq,
names = names(seq),
file.out = "full.alignment/GH48-alignment.ed.fasta")
# read data
seq <- read.fasta(file = "full.alignment/PL4-alignment.flank.pruned.fasta",seqtype = "DNA")
empty <- c()
for(i in 1:length(seq)){
empty[i] <- sum((seq[[i]] == "-")) / length(seq[[i]])
}
hist(empty)
# get sequences with more than 80% missing data and remove them
names(seq)[which(empty > 0.8)]
drop <- which(empty > 0.8)
# remove these sequences
if(length(drop != 0)){
seq <- seq[-drop]
}
# write fasta file
write.fasta(sequences = seq,
names = names(seq),
file.out = "full.alignment/PL4-alignment.ed.fasta")
# load libraries
library(seqinr)
# read data
seq <- read.fasta(file = "full.alignment/CE8-alignment.flank.pruned.fasta",seqtype = "DNA")
empty <- c()
for(i in 1:length(seq)){
empty[i] <- sum((seq[[i]] == "-")) / length(seq[[i]])
}
hist(empty)
# get sequences with more than 80% missing data and remove them
names(seq)[which(empty > 0.8)]
drop <- which(empty > 0.8)
# remove these sequences
if(length(drop != 0)){
seq <- seq[-drop]
}
# write fasta file
write.fasta(sequences = seq,
names = names(seq),
file.out = "full.alignment/CE8-alignment.ed.fasta")
